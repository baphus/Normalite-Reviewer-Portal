<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Import / Export - Normalite EDGE Admin</title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&amp;family=Noto+Sans:wght@100..900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#800000",
                        "accent": "#F59E0B",
                        "background-light": "#f8f5f5",
                        "background-dark": "#230f0f",
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"],
                        "body": ["Noto Sans", "sans-serif"],
                    },
                    borderRadius: {"DEFAULT": "0.375rem", "lg": "0.5rem", "xl": "0.75rem", "2xl": "1rem", "full": "9999px"},
                },
            },
        }
    </script>
<style>
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: transparent; 
        }
        ::-webkit-scrollbar-thumb {
            background: #d1d5db; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #9ca3af; 
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-[#1d0c0c] dark:text-white font-display overflow-hidden">
<div class="flex h-screen w-full">
<aside class="flex w-64 flex-col border-r border-[#e5e7eb] bg-white dark:bg-[#1a0a0a] dark:border-[#3a1a1a] transition-all duration-300 hidden md:flex shrink-0 z-20">
<div class="flex h-full flex-col justify-between p-4">
<div class="flex flex-col gap-6">
<div class="flex items-center gap-3 px-2 py-2">
<div class="bg-center bg-no-repeat bg-cover rounded-full h-10 w-10 shadow-sm border border-primary/20" data-alt="University Logo" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDRPPNAtErCq7KnUYhj2JsmJNhkhexjuGMyftx05EykHw3q1BlzO-71-JUqsyQSFSiag1qAKfi6bcA9G4HUgLH1lLaFzKMl9DKsXWwXV0LdNJ02QNwnvh0WdIdFpy2zVJg73wjkd-PXjqbBElMEF5bOGlukZ5tUK9GGdjXWh5MWEDuPjDjM55USlSs5AGGZgVZmG8pOwiXYtj1yKgNzA-AvvZAO9x3_VXoFCpwqbuUsTJFM7b4mNxI7kjy_2gqMFqaI0pkK4DcIYkVd");'>
</div>
<div class="flex flex-col">
<h1 class="text-primary text-lg font-bold leading-tight tracking-tight">Normalite EDGE</h1>
<p class="text-gray-500 text-xs font-normal">Admin Portal</p>
</div>
</div>
<nav class="flex flex-col gap-1">
<a class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-gray-600 hover:bg-gray-50 hover:text-primary dark:text-gray-300 dark:hover:bg-white/5 transition-colors" href="dashboard.html">
<span class="material-symbols-outlined text-[20px]">dashboard</span>
<p class="text-sm font-medium">Dashboard</p>
</a>
<a class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-gray-600 hover:bg-gray-50 hover:text-primary dark:text-gray-300 dark:hover:bg-white/5 transition-colors" href="exams.html">
<span class="material-symbols-outlined text-[20px]">assignment</span>
<p class="text-sm font-medium">Exams</p>
</a>
<a class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-gray-600 hover:bg-gray-50 hover:text-primary dark:text-gray-300 dark:hover:bg-white/5 transition-colors" href="questions.html">
<span class="material-symbols-outlined text-[20px]">quiz</span>
<p class="text-sm font-medium">Questions Bank</p>
</a>
<a class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-gray-600 hover:bg-gray-50 hover:text-primary dark:text-gray-300 dark:hover:bg-white/5 transition-colors" href="study.html">
<span class="material-symbols-outlined text-[20px]">style</span>
<p class="text-sm font-medium">Study</p>
</a>
<a class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-gray-600 hover:bg-gray-50 hover:text-primary dark:text-gray-300 dark:hover:bg-white/5 transition-colors" href="users.html">
<span class="material-symbols-outlined text-[20px]">group</span>
<p class="text-sm font-medium">Users</p>
</a>
<a class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-gray-600 hover:bg-gray-50 hover:text-primary dark:text-gray-300 dark:hover:bg-white/5 transition-colors" href="reports.html">
<span class="material-symbols-outlined text-[20px]">bar_chart</span>
<p class="text-sm font-medium">Reports</p>
</a>
<a class="flex items-center gap-3 px-3 py-2.5 rounded-lg bg-primary/10 text-primary group transition-colors" href="import-export.html">
<span class="material-symbols-outlined text-[20px] font-variation-settings-'FILL'1">import_export</span>
<p class="text-sm font-medium">Import / Export</p>
</a>
<a class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-gray-600 hover:bg-gray-50 hover:text-primary dark:text-gray-300 dark:hover:bg-white/5 transition-colors" href="settings.html">
<span class="material-symbols-outlined text-[20px]">settings</span>
<p class="text-sm font-medium">Settings</p>
</a>
</nav>
</div>
<div class="flex flex-col gap-4 border-t border-gray-100 pt-4 dark:border-white/10">
<div class="flex items-center gap-3 px-2">
<div class="h-9 w-9 rounded-full bg-gray-200 bg-cover bg-center border border-gray-300" data-alt="Admin profile" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDlj7X3FeByZgwcrzsXQJwePv-4yl8HA3bmTcnNF5lOgngG9vpjm_kyYznzAPZgPVIZ-iMHlmeLbCxxpq7CR0YM-1BmepRG_eeyil5lqU2SlUhs9CHW8_FrpUtQdHmoXzl8DTzoy5_otYgexhRADm4-hnUyPM1rjk5okTceIRQral4XdpNixjnPxWisoyjD-rAs9h-1yU_deBaVQXXGAgGafWOKjyID8Bj0sZqv-7JuPA06AKS6bvqdQNAoiXA1T1tArTvVkGymOOhr");'>
</div>
<div class="flex flex-col overflow-hidden">
<p class="text-sm font-medium text-gray-900 dark:text-white truncate">System Admin</p>
<p class="text-xs text-gray-500 truncate">Administrator</p>
</div>
</div>
<button class="flex w-full items-center gap-2 justify-center rounded-lg h-9 px-4 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-semibold transition-colors dark:bg-white/5 dark:border-white/10 dark:text-gray-300 dark:hover:bg-white/10" onclick="window.location.href='../dashboard.html'">
<span class="material-symbols-outlined text-[18px]">arrow_back</span>
<span>Back to Portal</span>
</button>
</div>
</div>
</aside>
<main class="flex-1 overflow-y-auto bg-background-light dark:bg-background-dark">
<div class="container mx-auto max-w-4xl px-4 sm:px-6 lg:px-8 py-8 flex flex-col gap-8">
<header class="flex flex-col gap-2">
<h1 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white tracking-tight">Import / Export Data</h1>
<p class="text-gray-500 dark:text-gray-400 text-base">Bulk manage system data using CSV or Excel files.</p>
</header>
<div class="grid grid-cols-1 md:grid-cols-2 gap-8">
<div class="bg-white dark:bg-[#1a0a0a] rounded-2xl p-8 border border-gray-100 dark:border-white/5 shadow-sm space-y-6">
<div class="h-12 w-12 bg-primary/10 rounded-xl flex items-center justify-center text-primary">
<span class="material-symbols-outlined text-2xl">upload_file</span>
</div>
<div>
<h3 class="text-xl font-bold text-gray-900 dark:text-white">Bulk Import</h3>
<p class="text-sm text-gray-500 mt-2">Upload questions, users, or subjects using our standard templates.</p>
</div>
                        <div class="space-y-4 pt-4">
                            <div class="p-4 rounded-xl bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/10">
                                <label class="block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">Import Type</label>
                                <select id="import-type" class="w-full bg-white dark:bg-black/20 border-gray-200 dark:border-white/10 rounded-lg text-sm">
                                    <option value="study">Study Material / Quiz</option>
                                    <option value="exam">Official Exam Bank</option>
                                    <option value="users">User Database</option>
                                </select>
                            </div>
                            <label class="block w-full py-6 px-4 rounded-xl border-2 border-dashed border-gray-200 dark:border-white/10 text-gray-500 hover:border-primary hover:text-primary transition-all text-sm font-bold text-center cursor-pointer">
                                <span class="material-symbols-outlined block text-3xl mb-2">cloud_upload</span>
                                Click to select or Drag & Drop File
                                <input type="file" id="bulk-import-file" class="hidden" accept=".csv,.json" onchange="updateFileName(this)">
                            </label>
                            <div id="file-name-display" class="hidden text-xs text-center font-bold text-primary bg-primary/5 py-2 rounded-lg"></div>
                            <div class="flex items-center justify-between text-xs text-gray-400 font-medium pt-2">
                                <span>Supported: .csv, .json</span>
                                <div class="flex gap-3">
                                    <button onclick="downloadAdminTemplate('csv')" class="text-primary hover:underline flex items-center gap-1">
                                        <span class="material-symbols-outlined text-[14px]">download</span> CSV Template
                                    </button>
                                    <button onclick="downloadAdminTemplate('json')" class="text-primary hover:underline flex items-center gap-1">
                                        <span class="material-symbols-outlined text-[14px]">download</span> JSON Template
                                    </button>
                                </div>
                            </div>
                        </div>
                        <button onclick="processBulkImport()" class="w-full bg-primary text-white font-bold py-3 rounded-xl hover:bg-primary/90 transition-colors shadow-sm">
                            Process Import
                        </button>
</div>
<div class="bg-white dark:bg-[#1a0a0a] rounded-2xl p-8 border border-gray-100 dark:border-white/5 shadow-sm space-y-6">
<div class="h-12 w-12 bg-accent/10 rounded-xl flex items-center justify-center text-accent">
<span class="material-symbols-outlined text-2xl">download</span>
</div>
<div>
<h3 class="text-xl font-bold text-gray-900 dark:text-white">System Export</h3>
<p class="text-sm text-gray-500 mt-2">Generate comprehensive data exports for backups or analysis.</p>
</div>
<div class="space-y-4 pt-4">
<div class="flex flex-col gap-2">
<label class="flex items-center gap-3 p-3 rounded-lg border border-gray-100 dark:border-white/5 cursor-pointer hover:bg-gray-50 dark:hover:bg-white/5">
<input class="text-primary focus:ring-primary h-4 w-4" name="export-type" type="radio"/>
<span class="text-sm font-medium">All Questions Bank</span>
</label>
<label class="flex items-center gap-3 p-3 rounded-lg border border-gray-100 dark:border-white/5 cursor-pointer hover:bg-gray-50 dark:hover:bg-white/5">
<input class="text-primary focus:ring-primary h-4 w-4" name="export-type" type="radio"/>
<span class="text-sm font-medium">Student Performance Data</span>
</label>
<label class="flex items-center gap-3 p-3 rounded-lg border border-gray-100 dark:border-white/5 cursor-pointer hover:bg-gray-50 dark:hover:bg-white/5">
<input class="text-primary focus:ring-primary h-4 w-4" name="export-type" type="radio"/>
<span class="text-sm font-medium">System Audit Logs</span>
</label>
</div>
</div>
<button class="w-full border-2 border-primary text-primary font-bold py-3 rounded-xl hover:bg-primary/5 transition-colors">
                            Generate Export
                        </button>
</div>
</div>
</div>
</main>
</div>
<script>
    function updateFileName(input) {
        const display = document.getElementById('file-name-display');
        if (input.files && input.files[0]) {
            display.textContent = `Selected: ${input.files[0].name}`;
            display.classList.remove('hidden');
        } else {
            display.classList.add('hidden');
        }
    }

    function downloadAdminTemplate(type) {
        let content = '';
        let filename = '';
        let mimeType = '';
        const importType = document.getElementById('import-type').value;

        if (importType === 'study') {
            if (type === 'json') {
                const template = [{
                    "question": "What is the capital of France?",
                    "options": ["London", "Berlin", "Paris", "Madrid"],
                    "correct_answer_index": 2,
                    "explanation": "Paris is the capital of France."
                }];
                content = JSON.stringify(template, null, 2);
                filename = 'study_template.json';
                mimeType = 'application/json';
            } else {
                content = 'question,option1,option2,option3,option4,correct_answer_index,explanation\n' +
                          '"What is the capital of France?","London","Berlin","Paris","Madrid",2,"Paris is the capital."';
                filename = 'study_template.csv';
                mimeType = 'text/csv';
            }
        } else if (importType === 'exam') {
            if (type === 'json') {
                const template = [{
                    "id": "Q1",
                    "text": "Sample Exam Question?",
                    "options": ["A", "B", "C", "D"],
                    "answer": 0,
                    "category": "Prof Ed",
                    "difficulty": "Easy"
                }];
                content = JSON.stringify(template, null, 2);
                filename = 'exam_bank_template.json';
                mimeType = 'application/json';
            } else {
                content = 'id,text,option1,option2,option3,option4,answer,category,difficulty\n' +
                          '"Q1","Sample?","A","B","C","D",0,"Gen Ed","Medium"';
                filename = 'exam_bank_template.csv';
                mimeType = 'text/csv';
            }
        } else {
            alert('Template for this type is coming soon.');
            return;
        }

        const blob = new Blob([content], { type: mimeType });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        window.URL.revokeObjectURL(url);
        document.body.removeChild(a);
    }

    function processBulkImport() {
        const fileInput = document.getElementById('bulk-import-file');
        const importType = document.getElementById('import-type').value;

        if (!fileInput.files || !fileInput.files[0]) {
            alert('Please select a file first.');
            return;
        }

        const file = fileInput.files[0];
        const reader = new FileReader();

        reader.onload = function(e) {
            try {
                const rawData = e.target.result;
                let parsedData = [];

                if (file.name.endsWith('.json')) {
                    parsedData = JSON.parse(rawData);
                } else {
                    const lines = rawData.split('\n');
                    const headers = lines[0].split(',').map(h => h.trim().toLowerCase());
                    for (let i = 1; i < lines.length; i++) {
                        if (!lines[i].trim()) continue;
                        const values = lines[i].split(',').map(v => v.trim().replace(/^"(.*)"$/, '$1'));
                        const obj = {};
                        headers.forEach((h, idx) => obj[h] = values[idx]);
                        parsedData.push(obj);
                    }
                }

                // Handle storage based on type
                if (importType === 'study') {
                    const customDecks = JSON.parse(localStorage.getItem('customDecks') || '[]');
                    const newDeck = {
                        id: Date.now(),
                        title: `Imported Study - ${new Date().toLocaleDateString()}`,
                        category: "Imported",
                        description: `Bulk imported from ${file.name}`,
                        cardCount: parsedData.length,
                        cards: parsedData.map(d => ({
                            front: d.question || d.front,
                            options: [d.option1, d.option2, d.option3, d.option4].filter(o => o),
                            answer: parseInt(d.correct_answer_index || d.answer || 0),
                            rationalization: d.explanation || d.rationalization || ""
                        })),
                        mastery: 0,
                        dateCreated: new Date().toISOString()
                    };
                    customDecks.push(newDeck);
                    localStorage.setItem('customDecks', JSON.stringify(customDecks));
                }

                alert(`Successfully processed ${parsedData.length} records!`);
                fileInput.value = '';
                document.getElementById('file-name-display').classList.add('hidden');
            } catch (err) {
                console.error(err);
                alert('Failed to process file. Check format.');
            }
        };

        reader.readAsText(file);
    }
</script>
</body></html>
